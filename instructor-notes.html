<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Quarto - instructor notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="instructor-notes_files/libs/clipboard/clipboard.min.js"></script>
<script src="instructor-notes_files/libs/quarto-html/quarto.js"></script>
<script src="instructor-notes_files/libs/quarto-html/popper.min.js"></script>
<script src="instructor-notes_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="instructor-notes_files/libs/quarto-html/anchor.min.js"></script>
<link href="instructor-notes_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="instructor-notes_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="instructor-notes_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="instructor-notes_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="instructor-notes_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Quarto - instructor notes</h1>
<p class="subtitle lead">Adapted from: https://cforgaci.github.io/r-socialsci/08-quarto.html</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="create-a-quarto-file" class="level2">
<h2 class="anchored" data-anchor-id="create-a-quarto-file">Create a Quarto file</h2>
<p>Quarto comes pre-installed with RStudio (as of v2022.07), so no action is necessary.</p>
<ul>
<li><p><code>RStudio, click File -&gt; New File -&gt; Quarto Document</code></p></li>
<li><p>Click on <code>Create Empty Document</code></p></li>
</ul>
</section>
<section id="create-a-quarto-file-1" class="level2">
<h2 class="anchored" data-anchor-id="create-a-quarto-file-1">Create a Quarto file</h2>
<p>To control the output, a YAML (YAML Ain’t Markup Language) header is needed:</p>
<pre><code>---
title: "My Awesome Report"
author: "Bilbo Baggins"
date: ""
format: html
---</code></pre>
<ul>
<li><p>The header is defined by the three hyphens at the beginning (<code>---</code>) and the three hyphens at the end (<code>---</code>).</p></li>
<li><p>You can add more information about your document in the YAML header, that will provide more information about the document or change the behaviour of the file.</p></li>
<li><p>You can also adapt the <code>format</code> of the file, to <code>pdf</code> or <code>docx</code>.</p></li>
</ul>
</section>
<section id="markdown-syntax" class="level2">
<h2 class="anchored" data-anchor-id="markdown-syntax">Markdown syntax</h2>
<ul>
<li><p>Markdown is a popular markup language that allows you to add formatting elements to text.</p></li>
<li><p>editing not visible in markdown -&gt; markdown converted to other file formats.</p></li>
</ul>
<section id="headings" class="level3">
<h3 class="anchored" data-anchor-id="headings">Headings</h3>
<p>A <code>#</code> in front of text indicates to Markdown that this text is a heading. Adding more <code>#</code>s goes makes heading smaller:</p>
<pre><code># Title
## Section
### Sub-section
#### Sub-sub section
##### Sub-sub-sub section
###### Sub-sub-sub-sub section</code></pre>
<ul>
<li><p>only use a level if the one above is also in use</p></li>
<li><p>probably not a great practice to have more than 3 subheadings.</p></li>
<li><p>Already have a title, so start from <code>##</code> to create introduction</p></li>
</ul>
<pre><code>## Introduction</code></pre>
</section>
<section id="formatting" class="level3">
<h3 class="anchored" data-anchor-id="formatting">Formatting</h3>
<ul>
<li><p><code>_</code> or <code>*</code> for <em>italics</em></p></li>
<li><p><code>__</code> or <code>**</code> for <strong>bold</strong></p></li>
<li><p>``<code>for</code>code-type`</p></li>
<li><p>You can use combination of those things (but do you realy want to?)</p></li>
</ul>
<pre><code>## Introduction

This report uses the `tidyverse` **package** along with the *diamonds* dataset, 
which has columns that include:</code></pre>
</section>
<section id="lists" class="level3">
<h3 class="anchored" data-anchor-id="lists">Lists</h3>
<pre><code>## Introduction

This report uses the **tidyverse** package along with the *SAFI* dataset, 
which has columns that include:

- carat
- cut
- price
- color</code></pre>
<ul>
<li>You can also create an ordered list using numbers:</li>
</ul>
<pre><code>1. carat
2. cut
3. price
4. color</code></pre>
<ul>
<li>And nested items by tab-indenting:</li>
</ul>
<pre><code>- carat
  + weight of the diamond
- cut
  + quality of the cut
- price
  + price in US dollars
- color
  + diamond colour, from D (best) to J (worst)</code></pre>
<p>Now we can render the document into HTML by clicking the <strong>Render</strong> button in the top of the Source pane (top left), or use the keyboard shortcut <kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>K</kbd> on Windows and Linux, and <kbd>Cmd</kbd>+<kbd>Shift</kbd>+<kbd>K</kbd> on Mac.</p>
<p>If you haven’t saved the document yet, you will be prompted to do so when you <strong>Render</strong> for the first time.</p>
</section>
</section>
<section id="writing-a-quarto-report" class="level2">
<h2 class="anchored" data-anchor-id="writing-a-quarto-report">Writing a Quarto report</h2>
<p>Now we will add some R code with some data wrangling and visualisation.</p>
<p>We need to make sure packages you need are loaded. We will use <strong>tidyverse</strong> .</p>
<p>It is not enough to load <strong>tidyverse</strong> from the console, we will need to load it within our Quarto document.</p>
<p>The same applies to our data.</p>
<p>To load these, we will need to create a <strong>‘code chunk’</strong> at the top of our document (below the YAML header).</p>
<p>A code chunk can be inserted by clicking <code>Code &gt; Insert Chunk</code>, or by using the keyboard shortcuts <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>I</kbd> on Windows and Linux, and <kbd>Cmd</kbd>+<kbd>Option</kbd>+<kbd>I</kbd> on Mac.</p>
<p>The syntax of a code chunk is:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: chunk-name</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="in"># Here is where you place the R code that you want to run.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>An Quarto document knows that this text is not part of the report from the <code>```</code> that begins and ends the chunk. It also knows that the code inside of the chunk is R code from the <code>r</code> inside of the curly braces (<code>{}</code>).</p>
<p>Below the curly braces, you can add code chunk options after the <code>#|</code> sign. In this way, you can for example add a label for the code chunk.</p>
<div class="callout callout-style-simple callout-none no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Naming a chunk is optional, but recommended. <strong>Each chunk label must be unique</strong>, and only contain alphanumeric characters and <code>-</code>.</p>
</div>
</div>
</div>
<p>To load <strong>tidyverse</strong> we will insert a chunk and call it ‘setup’.</p>
<p>Since we don’t want this code or the output to show in our knitted HTML document, we add an <code>#| include: false</code> option after the curly braces.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="in">#|label: setup</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="in">#|include: false</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(here)</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="in">diamonds_df &lt;- diamonds |&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="in">  select(carat, cut, price, color)</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important Note!
</div>
</div>
<div class="callout-body-container callout-body">
<p>The file paths you give in a .qmd document, e.g.&nbsp;to load a .csv file, are relative to the .qmd document, <strong>not</strong> the project root.</p>
<p>As suggested in the Starting with Data episode, we highly recommend the use of the <code>here()</code> function to keep the file paths consistent within your project.</p>
</div>
</div>
</section>
<section id="insert-table" class="level2">
<h2 class="anchored" data-anchor-id="insert-table">Insert table</h2>
<p>We will now create a table with some summary statistics about the dataset.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>It isn’t necessary to <strong>Render</strong> your document every time you want to see the output. Instead you can run the code chunk with the green triangle in the top right corner of the the chunk, or with the keyboard shortcuts: <kbd>Ctrl</kbd>+<kbd>Alt</kbd>+<kbd>C</kbd> on Windows and Linux, or <kbd>Cmd</kbd>+<kbd>Option</kbd>+<kbd>C</kbd> on Mac.</p>
</div>
</div>
<p>To make sure the table is formatted nicely in our output document, we will need to use the <code>kable()</code> function from the <strong>knitr</strong> package. The <code>kable()</code> function takes the output of your R code and renders it into a nice looking HTML table. You can also specify different aspects of the table, e.g.&nbsp;the column names, a caption, etc.</p>
<p>Run the code chunk to make sure you get the desired output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>diamonds_df <span class="sc">|&gt;</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>cut <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fair"</span>, <span class="st">"Good"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cut, color) <span class="sc">|&gt;</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean_price =</span> <span class="fu">mean</span>(price)) <span class="sc">|&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Cut"</span>, <span class="st">"Color"</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Average Price"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cut</th>
<th style="text-align: left;">Color</th>
<th style="text-align: right;">Average Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">3470.467</td>
</tr>
<tr class="even">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">3214.652</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">3778.820</td>
</tr>
<tr class="even">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">3872.754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">4535.390</td>
</tr>
<tr class="even">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">I</td>
<td style="text-align: right;">5255.880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">J</td>
<td style="text-align: right;">5103.513</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">3631.293</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">3538.914</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">4324.890</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">4500.742</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">5216.707</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">I</td>
<td style="text-align: right;">5946.181</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">J</td>
<td style="text-align: right;">6294.592</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">2629.095</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">2597.550</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">3374.939</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">3720.706</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">3889.335</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">I</td>
<td style="text-align: right;">4451.970</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">J</td>
<td style="text-align: right;">4918.186</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>When you are generating a table in Quarto the label should be prefixed with <code>tbl-</code>, e.g.&nbsp;<code>tbl-diamonds</code>.</p>
<p>You can add a caption to the chunk options with <code>tbl-cap: "Your caption here"</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-diamonds</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "A useful description about the table."</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: true</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="in">diamonds_df |&gt;</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(!cut %in% c("Fair", "Good")) |&gt;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(cut, color) |&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(mean_price = mean(price)) |&gt;</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="in">  knitr::kable(col.names = c("Cut", "Color", </span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="in">                             "Average Price"))</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-interview-out" class="cell anchored">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Cut</th>
<th style="text-align: left;">Color</th>
<th style="text-align: right;">Average Price</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">3470.467</td>
</tr>
<tr class="even">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">3214.652</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">3778.820</td>
</tr>
<tr class="even">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">3872.754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">4535.390</td>
</tr>
<tr class="even">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">I</td>
<td style="text-align: right;">5255.880</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Very Good</td>
<td style="text-align: left;">J</td>
<td style="text-align: right;">5103.513</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">3631.293</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">3538.914</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">4324.890</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">4500.742</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">5216.707</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">I</td>
<td style="text-align: right;">5946.181</td>
</tr>
<tr class="even">
<td style="text-align: left;">Premium</td>
<td style="text-align: left;">J</td>
<td style="text-align: right;">6294.592</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">D</td>
<td style="text-align: right;">2629.095</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">E</td>
<td style="text-align: right;">2597.550</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">F</td>
<td style="text-align: right;">3374.939</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">G</td>
<td style="text-align: right;">3720.706</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">H</td>
<td style="text-align: right;">3889.335</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">I</td>
<td style="text-align: right;">4451.970</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ideal</td>
<td style="text-align: left;">J</td>
<td style="text-align: right;">4918.186</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="customising-chunk-output" class="level2">
<h2 class="anchored" data-anchor-id="customising-chunk-output">Customising chunk output</h2>
<p>We mentioned using <code>include: false</code> in a code chunk to prevent the code and output from printing in the rendered document. There are additional options available to customise how the code-chunks are presented in the output document. The options are entered in the code chunk using the ‘hash pipe’, <code>#|</code>.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 72%">
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Options</th>
<th>Output</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>eval</code></td>
<td><code>TRUE</code> or <code>FALSE</code></td>
<td>Whether or not the code within the code chunk should be run.</td>
</tr>
<tr class="even">
<td><code>echo</code></td>
<td><code>TRUE</code> or <code>FALSE</code></td>
<td>Choose if you want to show your code chunk in the output document. <code>echo = TRUE</code> will show the code chunk.</td>
</tr>
<tr class="odd">
<td><code>include</code></td>
<td><code>TRUE</code> or <code>FALSE</code></td>
<td>Choose if the output of a code chunk should be included in the document. <code>FALSE</code> means that your code will run, but will not show up in the document.</td>
</tr>
<tr class="even">
<td><code>warning</code></td>
<td><code>TRUE</code> or <code>FALSE</code></td>
<td>Whether or not you want your output document to display potential warning messages produced by your code.</td>
</tr>
<tr class="odd">
<td><code>message</code></td>
<td><code>TRUE</code> or <code>FALSE</code></td>
<td>Whether or not you want your output document to display potential messages produced by your code.</td>
</tr>
<tr class="even">
<td><code>fig-align</code></td>
<td><code>default</code>, <code>left</code>, <code>right</code>, <code>center</code></td>
<td>Where the figure from your R code chunk should be output on the page</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>The default settings for the above chunk options are all <code>true</code>.</li>
<li>The default settings can be modified per chunk, or with <code>knitr::opts_chunk$set()</code>,</li>
<li>Entering <code>knitr::opts_chunk$set(echo = FALSE)</code> will change the default of value of <code>echo</code> to <code>FALSE</code> for <strong>every</strong> code chunk in the document.</li>
</ul>
<p>The defaults can also be changed in the YAML header with:</p>
<pre><code>---
knitr:
  opts_chunk:
    echo: false
---</code></pre>
</div>
</div>
</section>
<section id="exercise" class="level2 challenge">
<h2 class="anchored" data-anchor-id="exercise">Exercise</h2>
<p>Play around with the different options in the chunk with the code for the table, and re-<strong>Render</strong> to see what each option does to the output.</p>
<p>What happens if you use <code>eval: false</code> and <code>echo: false</code>? What is the difference between this and <code>include: false</code>?</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em> (Solution to Exercise). </span>Create a chunk with <code>eval: false, echo: false</code>, then create another chunk with <code>include: false</code> to compare. <code>eval: false</code> and <code>echo: false</code> will neither run the code in the chunk, nor show the code in the rendered document. The code chunk essentially doesn’t exist in the rendered document as it was never run. Whereas <code>include: false</code> will run the code and store the output for later use.</p>
</div>
</section>
<section id="in-line-r-code" class="level2">
<h2 class="anchored" data-anchor-id="in-line-r-code">In-line R code</h2>
<p>To use in-line R-code, we use the same backticks that we used in the Markdown section, with an <code>r</code> to specify that we are generating R-code.</p>
<p>The difference between in-line code and a code chunk is the number of backticks.</p>
<p>For example, today’s date is <code>`r Sys.Date()`</code>, will be rendered as: today’s date is 2024-10-23.</p>
<p>The code will display today’s date in the output document (well, technically the date the document was last rendered).</p>
<p>The best way to use in-line R code, is to minimise the amount of code you need to produce the in-line output by preparing the output in code chunks.</p>
<p>Let’s say we’re interested in presenting the average household size in a village.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a summary data frame with the mean price by cut</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>mean_price <span class="ot">&lt;-</span> diamonds_df <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(cut) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">mean_price =</span> <span class="fu">mean</span>(price))</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># and select the village we want to use</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>mean_ideal <span class="ot">&lt;-</span> mean_price <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(cut <span class="sc">==</span> <span class="st">"Ideal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can make an informative statement on the means of each cut, and include the mean values as in-line R-code. For example:</p>
<p>The average price of ideally cut diamonds is <code>`r round(mean_ideal$mean_price, 2)`</code>$.</p>
<p>becomes…</p>
<p>The average price of ideally cut diamonds is 3457.54$.</p>
<p>Because we are using in-line R code instead of the actual values, we have created a dynamic document that will automatically update if we make changes to the dataset and/or code chunks.</p>
</section>
<section id="plots" class="level2">
<h2 class="anchored" data-anchor-id="plots">Plots</h2>
<p>Plots created in Quarto should have a label prefixed with <code>fig-</code>, e.g. <code>#| label: fig-fancy-plot</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>diamonds_df <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> carat, <span class="at">y =</span> price)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> color), <span class="at">alpha =</span> <span class="fl">0.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-diamonds-plot" class="quarto-float quarto-figure quarto-figure-center anchored" width="672">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diamonds-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="instructor-notes_files/figure-html/fig-diamonds-plot-1.png" id="fig-diamonds-plot" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-diamonds-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also create a caption with the chunk option <code>fig-cap: "Caption here"</code>, and add some nicer labels using the <code>labs()</code> function.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-diamonds-plot</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "Yet another diamonds plot"</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: true</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="in">#| eval: false</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="in">diamonds_df %&gt;%</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = carat, y = price)) +</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(color = color), alpha = 0.6)+ </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Diamond weight (carat)", y = "Diamond price ($)", color = "Color") </span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>why put prefix in the labels of your tables in figures?</p>
<p>It allows you to cross-reference them in the text of your document, and it requires that the label is unique, and that they have the correct prefix.</p>
<p>For example, we can talk about the table we made earlier and reference it using the label <code>@tbl-diamonds</code>, which, when rendered, becomes Table 1.</p>
<p>We can do the same with our figures. For example, <code>@fig-diamonds-plot</code> becomes Figure 1. The number will of course depend on whether any plots or figures comes before it, but since you just need to reference the label, there’s no need to know what number a specific plot has in a document.</p>
</section>
<section id="other-output-options" class="level2">
<h2 class="anchored" data-anchor-id="other-output-options">Other output options</h2>
<p>You can convert Quarto to a PDF or a Word document (among others). Put <code>pdf</code> or <code>word</code> in the initial header of the file to indicate the desired output format.</p>
<pre><code>---
format: word
---</code></pre>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: Creating PDF documents
</div>
</div>
<div class="callout-body-container callout-body">
<p>Creating .pdf documents may require installation of some extra software. The R package <code>tinytex</code> provides some tools to help make this process easier for R users. With <code>tinytex</code> installed, run <code>tinytex::install_tinytex()</code> to install the required software (you’ll only need to do this once) and then when you render to pdf <code>tinytex</code> will automatically detect and install any additional LaTeX packages that are needed to produce the pdf document. Visit the <a href="https://yihui.org/tinytex/">tinytex website</a> for more information.</p>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note: Inserting citations into a Quarto file
</div>
</div>
<div class="callout-body-container callout-body">
<p>It is possible to insert citations into a Quarto file using the editor toolbar. The editor toolbar includes commonly seen formatting buttons generally seen in text editors (e.g., bold and italic buttons). The toolbar is accessible by using the settings dropdown menu (next to the ‘Render’ dropdown menu) to select ‘Use Visual Editor’, also accessible through the shortcut ‘Crtl+Shift+F4’. From here, clicking ‘Insert’ allows ‘Citation’ to be selected (shortcut: ‘Crtl+Shift+F8’). For example, searching ‘10.1007/978-3-319-24277-4’ in ‘From DOI’ and inserting will provide the citation for <code>ggplot2</code> <span class="citation" data-cites="wickham2016">[@wickham2016]</span>. This will also save the citation(s) in ‘references.bib’ in the current working directory.</p>
<p>Visit the <a href="https://rstudio.github.io/visual-markdown-editing/">R Studio website</a> for more information. Tip: obtaining citation information from relevant packages can be done by using <code>citation("package")</code>.</p>
</div>
</div>
</section>
<section id="resources" class="level2">
<h2 class="anchored" data-anchor-id="resources">Resources</h2>
<ul>
<li><a href="https://commonmark.org/help/tutorial/">Markdown tutorial</a></li>
<li><a href="https://quarto.org/">Official Quarto website</a> (comprehensive resource of tutorials and documentation)</li>
<li><a href="https://www.youtube.com/watch?v=yvi5uXQMvu4&amp;ab_channel=PositPBC">Welcome to Quarto</a> - workshop by Posit (former RStudio)</li>
<li><a href="https://bookdown.org/yihui/rmarkdown/">R Markdown: The Definitive Guide</a> - book by the RStudio team on R Markdown, the predecessor of Quarto</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>